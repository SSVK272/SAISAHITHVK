SELF JOIN EXCERISE: 

 SELECT M.ID,M.ENAME FROM EMPLOYEE E INNER JOIN EMPLOYEE M ON E.COMPID=M.COMPID AND E.ID<>M.ID WHERE M.ENAME NOT LIKE 'J%'



SELECT E.ID,E.ENAME,C.ID AS "MGRID",C.ENAME AS "MGRNAME",J.MAKE FROM EMPLOYEE E INNER JOIN COMPUTER C ON E.MANAGER=C.ID EMPLOYEE E INNER JOIN COMPUTER J ON E.COMPID=J.COMPID

-------------------------------------------------------------------------------------------------------------------------

EXCERISE - DAY 5:

48:
SELECT S.SID,S.SNAME,S.LOCATION FROM SALESMAN S INNER JOIN SALESMAN J ON S.SID=J.SID WHERE S.LOCATION IN ('London','Chicago')

49:
SELECT SNAME,SALEID FROM SALESMAN S LEFT OUTER JOIN SALE J ON S.SID=J.SID

50: (VERY IMPORTANT QUERY)

SELECT S1.SID, S1.SNAME, SUM(P1.PRICE*S3.QUANTITY) TAMOUNT, SUM((P1.PRICE*S3.QUANTITY)*P1.DISCOUNT/100) TDISCOUNT
FROM SALE S2 INNER JOIN SALESMAN S1 ON S1.SID=s2.SID INNER JOIN SALEDETAIL S3 ON S2.SALEID=S3.SALEID INNER JOIN PRODUCT P1 ON S3.PRODID = P1.PRODID GROUP BY S1.SID, S1.SNAME ORDER BY SUM(P1.PRICE*S3.QUANTITY) DESC.



51:
SELECT S2.SALEID,S3.PRODID,S1.SID,S1.SNAME FROM SALESMAN S1 INNER JOIN SALE S2 ON S1.SID=S2.SID INNER JOIN SALEDETAIL S3 ON S3.SALEID=S2.SALEID

52:(SIMILAR TO EXCERISE 50)
SELECT S1.SID, S1.SNAME, NVL(SUM(P1.PRICE*S3.QUANTITY),0) TAMOUNT, NVL(SUM((P1.PRICE*S3.QUANTITY)*P1.DISCOUNT/100),0) TDISCOUNT
FROM  SALESMAN S1 LEFT OUTER JOIN SALE S2 ON S1.SID=s2.SID 
   	LEFT OUTER JOIN SALEDETAIL S3 ON S2.SALEID=S3.SALEID 
   		LEFT OUTER JOIN PRODUCT P1 ON S3.PRODID = P1.PRODID 
   GROUP BY S1.SID, S1.SNAME 
   ORDER BY SUM(P1.PRICE*S3.QUANTITY) DESC

DAY 5 ASSIGNMENTS:


67:
SELECT E.ENAME,E.SAL,D.DNAME FROM EMP E INNER JOIN DEPT D ON E.DEPTNO=D.DEPTNO WHERE SAL>2000

68:
SELECT ENAME,DNAME FROM EMP E INNER JOIN DEPT D ON E.DEPTNO=D.DEPTNO WHERE JOB='MANAGER'


ASSIGNMENT 71:
 SELECT I.ITEMCODE,I.DESCR,Q.SNAME FROM ITEM I INNER JOIN QUOTATION Q ON I.ITEMCODE=Q.ITEMCODE



ASS 72:

SELECT C.CUSTID "Customer Id", C.CUSTNAME "Customer Name"

FROM CUSTOMER C INNER JOIN EMPDETAILS E

ON C.CUSTNAME=E.EMPNAME AND C.EMAILID=E.EMAILID


ASS 73:

SELECT I.ITEMCODE,I.DESCR,I.CATEGORY,Q.QUOTEDPRICE FROM ITEM I INNER JOIN QUOTATION Q ON I.ITEMCODE=Q.ITEMCODE WHERE Q.QSTATUS='Accepted'


ASS 74:
SELECT R.ROID,I.DESCR,I.ITEMTYPE,R.UNITPRICE FROM ITEM I INNER JOIN RETAILSTOCK R ON I.ITEMCODE=R.ITEMCODE WHERE R.UNITPRICE>1500



ASS 76:
SELECT I.ITEMCODE,I.DESCR FROM ITEM I INNER JOIN QUOTATION Q ON I.PRICE=Q.QUOTEDPRICE GROUP BY I.ITEMCODE,I.DESCR HAVING COUNT(*)>1


ASS 77:

SELECT Q.SNAME, Q.QUOTATIONID

FROM QUOTATION Q, ORDERS O

WHERE Q.QUOTATIONID=O.QUOTATIONID

AND O.DELIVEREDDATE-O.ORDERDATE<=5


----------------------------------------------------------------------------------------------------------------------------------------------------------------------

DAY 6 :

EXERCISE 59:
SELECT SALEID,SLDATE FROM SALE WHERE SLDATE = (SELECT MAX(SLDATE) FROM SALE);

EXERCISE 60:
SELECT SNAME FROM SALESMAN WHERE SID IN (SELECT SID FROM SALE GROUP BY SID HAVING COUNT(SID)>=2);

EXERCISE 61:
SELECT PRODID, PDESC FROM PRODUCT WHERE PRODID IN (SELECT PRODID FROM SALEDETAIL GROUP BY PRODID HAVING SUM(QUANTITY) = (SELECT MIN(SUM(QUANTITY)) FROM SALEDETAIL GROUP BY PRODID))


EXERCISE 62:


SELECT SID, SNAME, LOCATION FROM SALESMAN WHERE SID IN (SELECT SID FROM (SELECT S1.SID, SUM(((P.PRICE*S2.QUANTITY)*((100-P.DISCOUNT)/100))) TOTALAMOUNT FROM SALE S1, SALEDETAIL S2, PRODUCT P WHERE S1.SALEID=S2.SALEID AND S2.PRODID = P.PRODID GROUP BY S1.SID ORDER BY S1.SID) WHERE TOTALAMOUNT> (SELECT SUM(SUM(((P.PRICE*S2.QUANTITY)*((100-P.DISCOUNT)/100)))/SUM(S2.QUANTITY)) TOTALAMOUNT FROM SALE S1, SALEDETAIL S2, PRODUCT P WHERE S1.SALEID=S2.SALEID AND S2.PRODID = P.PRODID GROUP BY S1.SID))


EXERCISE 63:

SELECT P.PRODID , P.CATEGORY , P.PDESC, P.PRICE FROM PRODUCT P WHERE PRICE = (SELECT MAX(PRICE) FROM PRODUCT WHERE CATEGORY=P.CATEGORY)


EXERCISE 65:
SELECT SNAME FROM SALESMAN S WHERE EXISTS (SELECT * FROM SALE S1 WHERE S.SID=S1.SID AND TO_CHAR(S1.SLDATE, 'MM-YY')='06-15')


DAY 6 ASSIGNMENT :

ASS 93:

SELECT I.ITEMCODE,I.ITEMTYPE,I.DESCR,I.CATEGORY FROM ITEM I WHERE EXISTS (SELECT R.ITEMCODE FROM PURCHASEBILL R WHERE R.ITEMCODE=I.ITEMCODE)

ASS 94:

SELECT I.ITEMCODE,I.ITEMTYPE,I.DESCR,I.CATEGORY FROM ITEM I WHERE ITEMCODE=(SELECT DISTINCT ITEMCODE FROM QUOTATION WHERE  QUOTEDPRICE=(SELECT MIN(QUOTEDPRICE) FROM QUOTATION WHERE QSTATUS='Rejected'))

ASS 95:

SELECT ITEMCODE,DESCR FROM ITEM WHERE ITEMCODE=(SELECT DISTINCT ITEMCODE FROM QUOTATION WHERE QUOTEDPRICE =(SELECT MAX(QUOTEDPRICE) FROM QUOTATION WHERE QSTATUS='Closed' OR QSTATUS='Rejected'))

ASS 96:

SELECT ITEMCODE,DESCR,PRICE FROM ITEM WHERE PRICE=(SELECT MAX(PRICE) FROM ITEM WHERE PRICE<(SELECT MAX(PRICE) FROM ITEM))

ASS 98:
SELECT E.ENAME,E.JOB FROM EMP E WHERE EMPNO=(SELECT E1.EMPNO FROM EMPVEHICLE E1 WHERE E1.EMPNO=E.EMPNO)

ASS 99:
SELECT E.ENAME FROM EMP E WHERE SAL=(SELECT MAX(SAL) FROM EMP)

ASS 100:
SELECT EMPNO, ENAME FROM EMP WHERE EMPNO IN (SELECT EV1.EMPNO FROM EMPVEHICLE EV1, EMPVEHICLE EV2 WHERE EV1.VEHICLEID=EV2.VEHICLEID AND EV1.EMPNO<>EV2.EMPNO GROUP BY EV1.EMPNO)

ASS 102:
SELECT I.ITEMCODE, I.DESCR, Q.QDATE FROM ITEM I, QUOTATION Q WHERE I.ITEMCODE=Q.ITEMCODE AND Q.QUOTEDPRICE <(SELECT MAX(QUOTEDPRICE) FROM QUOTATION Q1 WHERE Q1.QDATE=Q.QDATE AND Q1.QUOTATIONID<>Q.QUOTATIONID)

ASS 103:

SELECT P.BILLID, P.ITEMCODE FROM PURCHASEBILL P WHERE P.BILLAMOUNT<=(SELECT AVG(P1.BILLAMOUNT) FROM PURCHASEBILL P1 WHERE P1.ROID=P.ROID GROUP BY ROID)









